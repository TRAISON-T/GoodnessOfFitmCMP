% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/goodness_of_fit.R
\name{estimate_rho_mCMP}
\alias{estimate_rho_mCMP}
\title{Estimator of rho_X(k) (Internal Helper)}
\usage{
estimate_rho_mCMP(x, mu, phi, k)
}
\arguments{
\item{x}{A numeric vector of sample data.}

\item{mu}{Numeric location parameter \eqn{\mu}.}

\item{phi}{Numeric dispersion parameter \eqn{\phi}.}

\item{k}{Integer for which \eqn{\rho_X(k)} is estimated.}
}
\value{
Numeric value of the estimator. Returns 0 if parameters lead to invalid calculations (e.g., \code{constant} is non-positive).
}
\description{
This internal helper function computes an estimator of \eqn{\rho_X(k)}, which represents
the probability mass function (PMF) of the mCMP distribution derived using Stein's characterization.
Stein's characterization is a powerful tool that allows the PMF to be expressed in a form
that avoids the computationally challenging normalizing constant present in the original mCMP PMF.
The estimator \eqn{\hat{\rho}_X(k)} is defined as:
\deqn{ \hat{\rho}_X(k) = \frac{1}{n}\sum_{i=1}^n \left( 1 - \left(\frac{\mu + \frac{e^\phi - 1}{2e^\phi}}{x_i + 1}\right)^{e^\phi} \right) I(x_i \ge k) }
where \eqn{x_i} are the observed sample values, \eqn{n} is the sample size, and \eqn{I(x_i \ge k)}
is the indicator function, which is 1 if \eqn{x_i \ge k} and 0 otherwise.
By the Law of Large Numbers, \eqn{\hat{\rho}_X(k)} converges in probability to \eqn{\rho_X(k)}.
}
\examples{
# Simulate some mCMP data
set.seed(123)
sample_data <- simulate_mcmp_sample(n = 50, mu = 5, phi = 0.1)

# Estimate rho_X(k) for specific k values
# Estimate rho_X(0) (probability of observing 0)
rho_0 <- estimate_rho_mCMP(x = sample_data, mu = 5, phi = 0.1, k = 0)
cat("Estimated rho_X(0):", rho_0, "\n")

# Estimate rho_X(1) (probability of observing 1)
rho_1 <- estimate_rho_mCMP(x = sample_data, mu = 5, phi = 0.1, k = 1)
cat("Estimated rho_X(1):", rho_1, "\n")

# Note: For internal use, this function is typically called by compute_hat_rho_vec.
}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/goodness_of_fit.R
\name{compute_mod_statistics}
\alias{compute_mod_statistics}
\title{Compute Goodness-of-Fit Test Statistics (Internal Helper)}
\usage{
compute_mod_statistics(sample, mu, phi)
}
\arguments{
\item{sample}{Numeric sample data.}

\item{mu}{Numeric location parameter \eqn{\mu} (typically an estimated value).}

\item{phi}{Numeric dispersion parameter \eqn{\phi} (typically an estimated value).}
}
\value{
A named numeric vector of test statistics (CV, AD, chi_sq, CV_M, AD_M, PD).
}
\description{
This internal helper function calculates various goodness-of-fit test statistics
to assess the fit of an mCMP distribution to observed sample data.
It computes both traditional and modified statistics, as detailed in the article.

\strong{Traditional Statistics:}
\itemize{
\item \strong{Cramér-von Mises (CV):} Measures the squared difference between the empirical
and theoretical cumulative distribution functions (CDFs), weighted by the theoretical PMF.
\deqn{ CV = n\sum_{x = 0}^{r} {{{\left[ {{F_n}\left( x \right) - F\left( {x;\mu ,\phi } \right)} \right]}^2}p\left( {x;\mu ,\phi } \right)} }
\item \strong{Anderson-Darling (AD):} Similar to CV, but gives more weight to the tails of the distribution.
\deqn{ AD = n\sum_{x = 0}^{r} {\frac{{{{\left[ {{F_n}\left( x \right) - F\left( {x;\mu ,\phi } \right)} \right]}^2}p\left( {x;\mu ,\phi } \right)}}{{F\left( {x;\mu ,\phi } \right)\left[ {1 - F\left( {x;\mu ,\phi } \right)} \right]}}} }
\item \strong{Chi-square (\eqn{\chi^2}):} Compares observed frequencies (\eqn{O_x}) with expected frequencies (\eqn{E_x})
under the hypothesized distribution.
\deqn{ \chi^2 = \sum_{x = 0}^{r} \frac{(O_x - E_x)^2}{E_x} }
}

\strong{Modified Statistics (using Stein's characterization):}
These statistics are proposed in the article to overcome computational challenges
due to the normalizing constant in the original mCMP PMF. They use the Stein-based
estimated PMF \eqn{\hat{\rho}_X(x)} and its corresponding CDF \eqn{F_{\hat{\rho}_X}(x)}.
\itemize{
\item \strong{Modified Cramér-von Mises (CV_M):}
\deqn{ C{V_M} = n\sum_{x = 0}^{r} {{{\left[ {{F_n}\left( x \right) - {F_{{{\hat \rho }_x}}}\left( {x;\mu ,\phi } \right)} \right]}^2}{{\hat \rho }_{X}(x)}} }
\item \strong{Modified Anderson-Darling (AD_M):}
\deqn{ AD_M = n\sum_{x = 0}^{r} {\frac{{{{\left[ {{F_n}\left( x \right) - {F_{{{\hat \rho }_{X}(x)}}}\left( {x;\mu ,\phi } \right)} \right]}^2}{{\hat \rho }_{X}(x)}}}{{{F_{{{\hat \rho }_{X}(x)}}}\left( {x;\mu ,\phi } \right)\left[ {1 - {F_{{{\hat \rho }_{X}(x)}}}\left( {x;\mu ,\phi } \right)} \right]}}} }
\item \strong{Probability Distance (PD):} Measures the sum of squared differences between
empirical probabilities and the Stein-based estimated probabilities.
\deqn{ PD = \sum_{j = 0}^{r} {\left( {{p_n}(j) - {{\hat \rho }_X}\left( j \right)} \right)} ^2}
}
Where \eqn{n} is the sample size, \eqn{r} is the maximum observed value, \eqn{p_n(x)} is the empirical probability,
\eqn{F_n(x)} is the empirical distribution function, \eqn{p(x;\mu,\phi)} and \eqn{F(x;\mu,\phi)} are the
mCMP PMF and CDF respectively, and \eqn{\hat{\rho}_X(x)} and \eqn{F_{\hat{\rho}_X}(x)} are the Stein-based
estimated PMF and its corresponding CDF.
}
\examples{
# Simulate some mCMP data
set.seed(456)
sample_data <- simulate_mcmp_sample(n = 100, mu = 6, phi = 0.2)

# Estimate parameters for the simulated data (as done in goodness_of_fit_mCMP)
estimated_params <- estimate_mu_phi(sample_data)
mu_est <- estimated_params[1]
phi_est <- estimated_params[2]

# Compute all goodness-of-fit test statistics
stats <- compute_mod_statistics(sample = sample_data, mu = mu_est, phi = phi_est)
print(stats)
}
\seealso{
\code{\link{dcmp}} for the mCMP PMF, \code{\link{estimate_rho_mCMP}} for the Stein-based estimator.
}
